var http = require('http');

var topics = {};

module.exports = {
  topics: function(woeid, callback) {
    http.get('http://api.twitter.com/1/trends/' + woeid + '.json', function(response) {
      var pageData = '';
      response.setEncoding('utf8');
      response.on('data', function (chunk) {
        pageData += chunk;
      });
      response.on('end', function(){
        try {
          topics[woeid] = JSON.parse(pageData)[0].trends;
          callback(topics[woeid]);
        }  catch (e) {}
      });
    });
  }
}